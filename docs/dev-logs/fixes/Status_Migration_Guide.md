# ç‹€æ…‹é·ç§»æŒ‡å—ï¼ˆStatus Migration Guideï¼‰

> **æ–‡ä»¶ç‰ˆè™Ÿ**ï¼šV1.0  
> **æœ€å¾Œæ›´æ–°**ï¼š2024-12-26  
> **ç›¸é—œè¦ç¯„**ï¼š`docs/spac/rules.md` ç¬¬ 2.2 ç¯€

---

## ç›®çš„

å°‡ç³»çµ±ä¸­æ‰€æœ‰èˆŠæ ¼å¼çš„ç‹€æ…‹å€¼ï¼ˆ`open`ã€`active`ã€`done` ç­‰ï¼‰è‡ªå‹•é·ç§»ç‚ºç¬¦åˆ `rules.md 2.2` è¦ç¯„çš„æ¨™æº–ç‹€æ…‹ã€‚

---

## æ¨™æº–ç‹€æ…‹å®šç¾©

æ ¹æ“š `rules.md 2.2`ï¼Œç³»çµ±åƒ…æ”¯æ´ä»¥ä¸‹ **5 å€‹æ¨™æº–ç‹€æ…‹**ï¼š

| ç‹€æ…‹å€¼ | ä¸­æ–‡åç¨± | èªªæ˜ |
|--------|---------|------|
| `not_started` | æœªé–‹å§‹ | ä»»å‹™å°šæœªé–‹å§‹åŸ·è¡Œ |
| `in_progress` | é€²è¡Œä¸­ | ä»»å‹™æ­£åœ¨é€²è¡Œä¸­ |
| `blocked` | å¡é—œ | ä»»å‹™é‡åˆ°é˜»ç¤™ï¼Œç„¡æ³•ç¹¼çºŒ |
| `awaiting_response` | å¾…å›è¦† | ç­‰å¾…å¤–éƒ¨å›è¦†æˆ–ç¢ºèª |
| `completed` | å·²å®Œæˆ | ä»»å‹™å·²å®Œæˆ |

---

## èˆŠç‹€æ…‹å°æ‡‰è¦å‰‡

é·ç§»å·¥å…·æœƒå°‡ä»¥ä¸‹èˆŠç‹€æ…‹è‡ªå‹•è½‰æ›ç‚ºæ¨™æº–ç‹€æ…‹ï¼š

### é€šç”¨èˆŠç‹€æ…‹
- `open` â†’ `not_started`ï¼ˆé–‹å•Ÿ/å¾…è™•ç† â†’ æœªé–‹å§‹ï¼‰
- `active` â†’ `in_progress`ï¼ˆæ´»èºä¸­ â†’ é€²è¡Œä¸­ï¼‰
- `done` â†’ `completed`ï¼ˆå·²å®Œæˆ â†’ å·²å®Œæˆï¼‰
- `pending` â†’ `awaiting_response`ï¼ˆå¾…è™•ç†/ç­‰å¾…ä¸­ â†’ å¾…å›è¦†ï¼‰
- `waiting` â†’ `awaiting_response`ï¼ˆç­‰å¾… â†’ å¾…å›è¦†ï¼‰
- `archived` â†’ `completed`ï¼ˆå·²æ­¸æª” â†’ å·²å®Œæˆï¼‰

### CR (Change Request) èˆŠç‹€æ…‹
- `requested` â†’ `in_progress`ï¼ˆå·²æå‡º â†’ é€²è¡Œä¸­ï¼‰
- `reviewing` â†’ `in_progress`ï¼ˆè©•ä¼°ä¸­ â†’ é€²è¡Œä¸­ï¼‰
- `approved` â†’ `completed`ï¼ˆå·²æ ¸å‡† â†’ å·²å®Œæˆï¼‰
- `rejected` â†’ `completed`ï¼ˆå·²é§å› â†’ å·²å®Œæˆï¼‰
- `implemented` â†’ `completed`ï¼ˆå·²å¯¦ä½œ â†’ å·²å®Œæˆï¼‰
- `canceled` â†’ `completed`ï¼ˆå·²å–æ¶ˆ â†’ å·²å®Œæˆï¼‰

### Decision èˆŠç‹€æ…‹
- `superseded` â†’ `completed`ï¼ˆå·²è¢«å–ä»£ â†’ å·²å®Œæˆï¼‰
- `deprecated` â†’ `completed`ï¼ˆå·²å»¢æ­¢ â†’ å·²å®Œæˆï¼‰

---

## è‡ªå‹•é·ç§»æ©Ÿåˆ¶

### åŸ·è¡Œæ™‚æ©Ÿ
ç³»çµ±æœƒåœ¨æ¯æ¬¡å•Ÿå‹•æ™‚è‡ªå‹•æª¢æŸ¥æ˜¯å¦éœ€è¦åŸ·è¡Œé·ç§»ï¼š

1. **æª¢æŸ¥æ¢ä»¶**ï¼š
   - å°šæœªåŸ·è¡Œéé·ç§»ï¼ˆlocalStorage ä¸­æ²’æœ‰ `status_migration_completed` æ¨™è¨˜ï¼‰
   - åµæ¸¬åˆ° localStorage ä¸­å­˜åœ¨ä½¿ç”¨èˆŠç‹€æ…‹çš„è³‡æ–™

2. **è‡ªå‹•åŸ·è¡Œ**ï¼š
   - å¦‚æœæ»¿è¶³æ¢ä»¶ï¼Œç³»çµ±æœƒåœ¨ `App.tsx` çš„ `useEffect` ä¸­è‡ªå‹•åŸ·è¡Œé·ç§»
   - é·ç§»å®Œæˆå¾Œæœƒåœ¨ Console é¡¯ç¤ºï¼š`âœ… ç‹€æ…‹é·ç§»å®Œæˆï¼Œå…±æ›´æ–° X ç­†ä»»å‹™`

3. **åŸ·è¡Œä¸€æ¬¡**ï¼š
   - é·ç§»æˆåŠŸå¾Œæœƒåœ¨ localStorage è¨­å®š `status_migration_completed` æ™‚é–“æˆ³
   - ä¹‹å¾Œå•Ÿå‹•ç³»çµ±ä¸æœƒé‡è¤‡åŸ·è¡Œ

### é·ç§»ç¯„åœ
- **Items**ï¼šæ‰€æœ‰ `items_` é–‹é ­çš„ localStorage key
- **Work Packages**ï¼šæ‰€æœ‰ `work_packages_` é–‹é ­çš„ localStorage key

---

## æ‰‹å‹•ç®¡ç†å·¥å…·

å¦‚éœ€æ‰‹å‹•æª¢æŸ¥æˆ–é‡æ–°åŸ·è¡Œé·ç§»ï¼Œè«‹å‰å¾€ï¼š

**è·¯å¾‘**ï¼šè¨­å®š â†’ ç³»çµ±ç®¡ç† â†’ ç‹€æ…‹é·ç§»

### åŠŸèƒ½èªªæ˜

#### 1. é·ç§»ç‹€æ…‹æª¢æŸ¥
- é¡¯ç¤ºé·ç§»æ˜¯å¦å·²å®ŒæˆåŠå®Œæˆæ™‚é–“
- é¡¯ç¤ºæ˜¯å¦åµæ¸¬åˆ°éœ€è¦é·ç§»çš„èˆŠç‹€æ…‹
- åˆ—å‡ºæ‰€æœ‰æ‰¾åˆ°çš„èˆŠç‹€æ…‹é¡å‹

#### 2. åŸ·è¡Œé·ç§»
- é»æ“Šã€ŒåŸ·è¡Œé·ç§»ã€æŒ‰éˆ•æ‰‹å‹•è§¸ç™¼é·ç§»
- é¡¯ç¤ºé·ç§»é€²åº¦èˆ‡çµæœ

#### 3. é‡ç½®æ¨™è¨˜
- ç”¨æ–¼é–‹ç™¼æ¸¬è©¦ï¼šæ¸…é™¤ `status_migration_completed` æ¨™è¨˜
- é‡ç½®å¾Œå¯å†æ¬¡åŸ·è¡Œé·ç§»

---

## å¯¦ä½œæª”æ¡ˆ

### æ ¸å¿ƒæª”æ¡ˆ

1. **`/src/lib/storage/statusMigration.ts`**
   - é·ç§»é‚è¼¯æ ¸å¿ƒ
   - æä¾› `needsMigration()`ã€`migrateAllItemsStatus()`ã€`isLegacyStatus()` ç­‰å‡½æ•¸

2. **`/src/app/App.tsx`**
   - åœ¨æ‡‰ç”¨å•Ÿå‹•æ™‚è‡ªå‹•æª¢æŸ¥ä¸¦åŸ·è¡Œé·ç§»
   - ä½¿ç”¨ `useEffect` hook

3. **`/src/lib/storage/statusHelpers.ts`**
   - å·²ç§»é™¤å‘å¾Œç›¸å®¹é‚è¼¯ï¼ˆ`legacyStatusMap`ï¼‰
   - åƒ…æ”¯æ´ 5 å€‹æ¨™æº–ç‹€æ…‹çš„é¡¯ç¤ºèˆ‡é¡è‰²

4. **`/src/app/settings/StatusMigrationPanel.tsx`**
   - æä¾›æ‰‹å‹•é·ç§»ç®¡ç†ä»‹é¢
   - æ•´åˆæ–¼ç³»çµ±è¨­å®šé é¢

---

## æ¸¬è©¦æ–¹å¼

### 1. å»ºç«‹æ¸¬è©¦è³‡æ–™
åœ¨ Console åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤å»ºç«‹åŒ…å«èˆŠç‹€æ…‹çš„æ¸¬è©¦è³‡æ–™ï¼š

```javascript
// å»ºç«‹æ¸¬è©¦é …ç›®
const testItems = [
  { id: 'test-1', title: 'æ¸¬è©¦ä»»å‹™ 1', status: 'open', type: 'general' },
  { id: 'test-2', title: 'æ¸¬è©¦ä»»å‹™ 2', status: 'active', type: 'general' },
  { id: 'test-3', title: 'æ¸¬è©¦ä»»å‹™ 3', status: 'done', type: 'general' },
];

localStorage.setItem('items_test-project', JSON.stringify(testItems));
```

### 2. æ¸…é™¤é·ç§»æ¨™è¨˜
```javascript
localStorage.removeItem('status_migration_completed');
```

### 3. é‡æ–°æ•´ç†é é¢
ç³»çµ±æœƒè‡ªå‹•åµæ¸¬ä¸¦åŸ·è¡Œé·ç§»ï¼ŒConsole æœƒé¡¯ç¤ºï¼š
```
ğŸ”„ æª¢æ¸¬åˆ°èˆŠç‹€æ…‹æ•¸æ“šï¼Œé–‹å§‹é·ç§»...
[StatusMigration] Item "æ¸¬è©¦ä»»å‹™ 1": "open" â†’ "not_started"
[StatusMigration] Item "æ¸¬è©¦ä»»å‹™ 2": "active" â†’ "in_progress"
[StatusMigration] Item "æ¸¬è©¦ä»»å‹™ 3": "done" â†’ "completed"
âœ… ç‹€æ…‹é·ç§»å®Œæˆï¼Œå…±æ›´æ–° 3 ç­†ä»»å‹™
```

### 4. é©—è­‰çµæœ
åœ¨ Console æª¢æŸ¥è³‡æ–™ï¼š
```javascript
JSON.parse(localStorage.getItem('items_test-project'))
```

æ‡‰è©²çœ‹åˆ°æ‰€æœ‰ `status` æ¬„ä½å·²æ›´æ–°ç‚ºæ¨™æº–ç‹€æ…‹ã€‚

---

## æ³¨æ„äº‹é …

1. **è³‡æ–™å®‰å…¨**ï¼š
   - é·ç§»ä¸æœƒåˆªé™¤åŸå§‹è³‡æ–™
   - åƒ…æ›´æ–° `status` æ¬„ä½

2. **å‘å¾Œç›¸å®¹æ€§**ï¼š
   - `statusHelpers.ts` å·²ç§»é™¤èˆŠç‹€æ…‹æ”¯æ´
   - å¦‚æœé·ç§»å¤±æ•—ï¼Œæœªè½‰æ›çš„èˆŠç‹€æ…‹æœƒé¡¯ç¤ºç‚ºè­¦å‘Šè‰²ä¸¦åœ¨ Console è¨˜éŒ„è­¦å‘Š

3. **ä¸€æ¬¡æ€§æ“ä½œ**ï¼š
   - é·ç§»æ¨™è¨˜è¨­å®šå¾Œä¸æœƒè‡ªå‹•é‡è¤‡åŸ·è¡Œ
   - å¦‚éœ€é‡æ–°é·ç§»ï¼Œè«‹ä½¿ç”¨ã€Œé‡ç½®æ¨™è¨˜ã€åŠŸèƒ½

4. **æ•ˆèƒ½å½±éŸ¿**ï¼š
   - é·ç§»åƒ…åœ¨é¦–æ¬¡å•Ÿå‹•æ™‚åŸ·è¡Œä¸€æ¬¡
   - å°ç³»çµ±æ•ˆèƒ½ç„¡æŒçºŒå½±éŸ¿

---

## ç–‘é›£æ’è§£

### Q: é·ç§»å¾Œä»çœ‹åˆ°èˆŠç‹€æ…‹æ¨™ç±¤ï¼Ÿ
**A**: è«‹é‡æ–°æ•´ç†é é¢ï¼Œç¢ºä¿æ‰€æœ‰å…ƒä»¶é‡æ–°è¼‰å…¥è³‡æ–™ã€‚

### Q: å¦‚ä½•ç¢ºèªé·ç§»æ˜¯å¦æˆåŠŸï¼Ÿ
**A**: å‰å¾€ã€Œè¨­å®š â†’ ç³»çµ±ç®¡ç† â†’ ç‹€æ…‹é·ç§»ã€æŸ¥çœ‹é·ç§»ç‹€æ…‹ã€‚

### Q: å¯ä»¥å›å¾©åˆ°èˆŠç‹€æ…‹å—ï¼Ÿ
**A**: é·ç§»ä¸å¯é€†ã€‚å»ºè­°åœ¨æ­£å¼ç’°å¢ƒåŸ·è¡Œå‰å…ˆå‚™ä»½ localStorage è³‡æ–™ã€‚

### Q: å¦‚æœé‡åˆ°å®Œå…¨æœªçŸ¥çš„ç‹€æ…‹ï¼Ÿ
**A**: ç³»çµ±æœƒå°‡æœªçŸ¥ç‹€æ…‹é è¨­ç‚º `not_started`ï¼Œä¸¦åœ¨ Console è¨˜éŒ„è­¦å‘Šè¨Šæ¯ã€‚

---

## ç›¸é—œæ–‡ä»¶

- `/docs/spac/rules.md` - å…¨åŸŸæ¥­å‹™è¦å‰‡ï¼ˆç¬¬ 2.2 ç¯€å®šç¾©æ¨™æº–ç‹€æ…‹ï¼‰
- `/guidelines/Product_Context.md` - ç”¢å“èƒŒæ™¯èˆ‡æ ¸å¿ƒæ¦‚å¿µ