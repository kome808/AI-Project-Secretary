# 模組：系統設定（Admin Only）

## 目標
提供系統級配置入口：AI 供應商/模型、API Key、儲存模式、全域政策。

## 權限
僅系統管理員可見。

## UI 需求（MVP）
- AI 供應商/模型選擇
- API Key 管理：遮罩顯示、更新操作（Key 僅存後端並加密）
- 儲存模式顯示（Local / Supabase）
- 全域政策（Citation/遮罩規則）可見（可先只讀）

## 驗收標準
- 非 Admin 不可進入
- Key 不落地前端/localStorage

## 子功能：專案管理（Projects）（Admin Only）

### 目標
系統管理員可建立/編輯專案，並管理專案生命週期狀態：啟用、封存、刪除（延遲刪除可恢復）。

### 主要情境
1) Admin 建立新專案，指定 PM、初始成員，並送出邀請。
2) 專案結案後 Admin 將專案「封存」，成員仍可查閱但不可再修改。
3) 專案誤建或需移除時 Admin「刪除專案」：先標記刪除，30 天內可恢復，30 天後永久刪除。

### 狀態定義與規則
- **啟用（Active）**：成員可正常讀寫（新增 Artifact、Inbox Confirm、改任務/指派/期限、設定等）。
- **封存（Archived）＝唯讀模式**：
  - ✅可讀：任務、待回覆、決議、變更、文件庫、Citation 皆可查看與搜尋
  - ❌不可寫：不可新增/上傳、不可 Inbox Confirm、不可改狀態/指派/期限、不可新增成員、不可修改設定
  - UI 必須顯示明顯 Banner：「此專案已封存（唯讀）」
- **刪除（Soft Delete → 30 天後 Purge）**：
  - 第一步為「標記刪除（Pending Deletion）」並記錄刪除時間與預計永久刪除日（+30 天）
  - 標記刪除後：專案不可編輯（建議不可進入；或僅 Admin 可見倒數與恢復按鈕）
  - 30 天內 Admin 可「恢復（Restore）」
  - 30 天後自動「永久刪除（Purge）」：刪除專案及所有關聯資料（Artifacts/Items/成員/設定/索引向量等）

### UI 需求（MVP）
- Projects 清單：專案名稱、PM、狀態、更新時間
- 狀態篩選：啟用 / 封存 / 待刪除 / 已刪除（若有）
- 專案操作：
  - 建立：輸入名稱/代號/描述（可選）、指定 PM（可選）、初始化成員（可選）
  - 編輯：可改名稱/描述/PM（不影響歷史資料）
  - 封存/啟用切換：一鍵切換（封存需提示「將進入唯讀」）
  - 刪除：二段式確認（需輸入專案名稱或輸入 DELETE），並顯示「30 天後永久刪除」倒數
  - 恢復：僅在待刪除期間提供「恢復」按鈕

### 驗收標準（AC）
1) Admin 可建立專案並在清單看到。
2) 專案設為封存後，成員仍可查看但所有寫入操作被禁止（含 Inbox Confirm、任務更新、文件上傳）。
3) Admin 觸發刪除後，專案進入待刪除狀態並顯示永久刪除日期。
4) 待刪除 30 天內可恢復，恢復後專案回到啟用且資料完整。
5) 永久刪除（Purge）發生後，專案與資料不可再被搜尋/存取。
