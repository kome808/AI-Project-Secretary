# AI å°è©±æ•´åˆè¨ˆç•«

## å•é¡Œèªªæ˜

ç›®å‰ç³»çµ±çš„ AI ç§˜æ›¸åŠŸèƒ½æ˜¯ã€Œå‡ AIã€ï¼š
- âŒ ä½¿ç”¨é—œéµå­—åŒ¹é…åˆ¤æ–·æ„åœ–
- âŒ ä»»ä½•è¼¸å…¥éƒ½ç›´æ¥å»ºç«‹å»ºè­°å¡ï¼ˆåŒ…æ‹¬ã€ŒHIHIã€é€™ç¨®é–’èŠï¼‰
- âŒ æ²’æœ‰çœŸæ­£çš„å°è©±èƒ½åŠ›
- âŒ ç„¡æ³•ç†è§£ä½¿ç”¨è€…æ„åœ–

## é æœŸè¡Œç‚º

çœŸæ­£çš„ AI ç§˜æ›¸æ‡‰è©²ï¼š
1. **å°è©±å„ªå…ˆ**ï¼šå…ˆèˆ‡ä½¿ç”¨è€…å°è©±ï¼Œç†è§£æ„åœ–
2. **æ™ºèƒ½åˆ¤æ–·**ï¼šåˆ¤æ–·æ˜¯é–’èŠã€è©¢å•ã€é‚„æ˜¯ä»»å‹™ç›¸é—œ
3. **ç¢ºèªå¾ŒåŸ·è¡Œ**ï¼šåªæœ‰ç¢ºèªæ˜¯ä»»å‹™ç›¸é—œï¼Œæ‰å»ºç«‹å»ºè­°å¡
4. **ä¿ç•™è„ˆçµ¡**ï¼šè¨˜ä½å°è©±æ­·å²ï¼Œå½¢æˆä¸Šä¸‹æ–‡

## å¯¦ä½œæ¶æ§‹

ç³»çµ±å·²ç¶“æœ‰å®Œæ•´çš„ AI æœå‹™ï¼Œåªæ˜¯æ²’æœ‰è¢«ä½¿ç”¨ï¼š

### ç¾æœ‰çµ„ä»¶ï¼ˆå·²å¯¦ä½œï¼‰
- âœ… `/src/lib/ai/AIService.ts` - AI æœå‹™é¡åˆ¥
- âœ… `/src/hooks/useAIChat.ts` - AI å°è©± Hook
- âœ… `/src/lib/ai/prompts.ts` - Prompt ç¯„æœ¬
- âœ… `/src/lib/ai/types.ts` - TypeScript é¡å‹å®šç¾©
- âœ… `/src/app/settings/AISettingsPage.tsx` - AI è¨­å®šé é¢

### æ ¸å¿ƒæµç¨‹

```
ä½¿ç”¨è€…è¼¸å…¥
    â†“
AI æ„åœ–åˆ†é¡ (classifyIntent)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ„åœ–åˆ¤æ–·         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“         â†“         â†“
é–’èŠ       è©¢å•      ä»»å‹™
    â†“         â†“         â†“
ç›´æ¥å›æ‡‰   å›ç­”å•é¡Œ   å°è©±ç¢ºèª
                        â†“
                  ç¢ºèªç´°ç¯€å®Œæ•´
                        â†“
                  å»ºç«‹å»ºè­°å¡
```

### æ„åœ–é¡å‹ (IntentType)

ç³»çµ±å·²å®šç¾©ä»¥ä¸‹æ„åœ–é¡å‹ï¼š

```typescript
export type IntentType =
  | 'create_task'          // å»ºç«‹ä»»å‹™
  | 'create_pending'       // å»ºç«‹å¾…å›è¦†äº‹é …
  | 'create_cr'            // å»ºç«‹è®Šæ›´éœ€æ±‚
  | 'create_decision'      // è¨˜éŒ„æ±ºè­°
  | 'query_status'         // æŸ¥è©¢ç‹€æ…‹
  | 'modify'               // ä¿®æ”¹é …ç›®
  | 'clarification'        // éœ€è¦æ¾„æ¸…
  | 'casual_chat';         // é–’èŠ
```

## æ”¹é€²è¨ˆç•«

### éšæ®µ 1ï¼šä½¿ç”¨ç¾æœ‰ AI æœå‹™ï¼ˆç«‹å³å¯åšï¼‰

ä¿®æ”¹ `InboxPage` å’Œ `DashboardPage` çš„ `handleAIInput` å‡½æ•¸ï¼š

```typescript
const handleAIInput = async (input: string, file?: File) => {
  // 1. å‘¼å«çœŸæ­£çš„ AI Service
  const aiResponse = await useAIChat.chat(input);
  
  // 2. æ ¹æ“šæ„åœ–æ±ºå®šè¡Œç‚º
  if (aiResponse.intent === 'casual_chat' || aiResponse.intent === 'query_status') {
    // é–’èŠæˆ–è©¢å•ï¼šé¡¯ç¤ºå°è©±å›æ‡‰ï¼Œä¸å»ºç«‹å¡ç‰‡
    showChatMessage(aiResponse.reply);
  } else if (aiResponse.intent.startsWith('create_')) {
    // ä»»å‹™ç›¸é—œï¼šå»ºç«‹å»ºè­°å¡
    createSuggestionCard(aiResponse);
  } else {
    // éœ€è¦æ¾„æ¸…ï¼šè¦æ±‚æ›´å¤šè³‡è¨Š
    showClarificationDialog(aiResponse.clarifications);
  }
};
```

### éšæ®µ 2ï¼šåŠ å…¥å°è©±ä»‹é¢ï¼ˆéœ€æ–°å¢ï¼‰

åœ¨ AI ç§˜æ›¸å€å¡ŠåŠ å…¥ï¼š
- å°è©±æ°£æ³¡é¡¯ç¤ºå€
- æ­·å²å°è©±ç´€éŒ„
- ä¸Šä¸‹æ–‡è¨˜æ†¶

### éšæ®µ 3ï¼šå¤šè¼ªå°è©±ï¼ˆé€²éšï¼‰

æ”¯æ´ AI è¿½å•ç´°ç¯€ï¼š
```
ä½¿ç”¨è€…ï¼šæ˜å¤©è¦äº¤å ±å‘Š
AIï¼šå¥½çš„ï¼Œæˆ‘å¹«ä½ å»ºç«‹ä»»å‹™ã€‚è«‹å•é€™ä»½å ±å‘Šçš„æ¨™é¡Œæ˜¯ä»€éº¼ï¼Ÿ
ä½¿ç”¨è€…ï¼šæœˆåº¦é€²åº¦å ±å‘Š
AIï¼šäº†è§£ã€‚éœ€è¦æŒ‡æ´¾è² è²¬äººå—ï¼Ÿ
ä½¿ç”¨è€…ï¼šæŒ‡æ´¾çµ¦ Alice
AIï¼šå®Œæˆï¼å·²å»ºç«‹ä»»å‹™ã€Œæœˆåº¦é€²åº¦å ±å‘Šã€ï¼Œåˆ°æœŸæ—¥ 2025/12/24ï¼Œè² è²¬äºº Alice
```

## ç«‹å³å¯åŸ·è¡Œçš„ä¿®æ”¹

ç”±æ–¼æ™‚é–“é™åˆ¶ï¼Œæˆ‘å»ºè­°å…ˆå®Œæˆ **æœ€å°å¯è¡Œç‰ˆæœ¬**ï¼š

### ä¿®æ”¹ç¯„åœ
1. âœ… æ›´æ–° `InboxPage.tsx` çš„ `handleAIInput`
2. âœ… æ›´æ–° `DashboardPage.tsx` çš„ `handleAIInput`
3. âœ… åŠ å…¥å°è©±å›æ‡‰é¡¯ç¤ºå€åŸŸ
4. âœ… ç§»é™¤é—œéµå­—åŒ¹é…çš„ `GeneratorService.generateSuggestions`

### æ–°å¢åŠŸèƒ½
- å°è©±æ°£æ³¡ï¼ˆä½¿ç”¨è€…è¼¸å…¥ / AI å›æ‡‰ï¼‰
- æ„åœ–åˆ¤æ–·çµæœé¡¯ç¤º
- åªæœ‰ç¢ºèªæ˜¯ä»»å‹™æ™‚æ‰å»ºç«‹å»ºè­°å¡

### ä¿ç•™åŠŸèƒ½
- Prompt Chips å¿«é€Ÿè¼¸å…¥
- æ‰¹æ¬¡æ“ä½œ
- ç·¨è¼¯å»ºè­°å¡

## ç¯„ä¾‹ä½¿ç”¨æƒ…å¢ƒ

### æƒ…å¢ƒ 1ï¼šé–’èŠ
```
ä½¿ç”¨è€…ï¼šHi
AIï¼šæ‚¨å¥½ï¼æˆ‘æ˜¯æ‚¨çš„å°ˆæ¡ˆç§˜æ›¸ï¼Œæœ‰ä»€éº¼å¯ä»¥å¹«æ‚¨çš„å—ï¼Ÿ
```
â†’ ä¸å»ºç«‹ä»»ä½•å¡ç‰‡

### æƒ…å¢ƒ 2ï¼šè©¢å•
```
ä½¿ç”¨è€…ï¼šç›®å‰æœ‰å¹¾å€‹å¾…è¾¦äº‹é …ï¼Ÿ
AIï¼šç›®å‰æœ‰ 5 å€‹å¾…è¾¦äº‹é …ï¼Œå…¶ä¸­ 2 å€‹å·²é€¾æœŸï¼Œéœ€è¦å„ªå…ˆè™•ç†ã€‚
```
â†’ ä¸å»ºç«‹ä»»ä½•å¡ç‰‡

### æƒ…å¢ƒ 3ï¼šå»ºç«‹ä»»å‹™
```
ä½¿ç”¨è€…ï¼š2025/12/30è¦ç¹³äº¤å°ˆæ¡ˆå·¥ä½œè¨ˆç•«æ›¸
AIï¼šå¥½çš„ï¼æˆ‘å¹«æ‚¨å»ºç«‹ä¸€å€‹ä»»å‹™ï¼š
    - æ¨™é¡Œï¼šç¹³äº¤å°ˆæ¡ˆå·¥ä½œè¨ˆç•«æ›¸
    - åˆ°æœŸæ—¥ï¼š2025/12/30
    - é¡å‹ï¼šè¡Œå‹•é …
    è«‹ç¢ºèªæ˜¯å¦æ­£ç¢ºï¼Ÿ
```
â†’ å»ºç«‹å»ºè­°å¡

## æŠ€è¡“ç´°ç¯€

### API å‘¼å«æµç¨‹

```typescript
// 1. åˆå§‹åŒ– AI Hook
const { chat, isLoading, error } = useAIChat({
  projectId: currentProject.id,
  projectName: currentProject.name,
  currentPhase: 'é–‹ç™¼éšæ®µ',
  teamMembers: members.map(m => m.name)
});

// 2. ç™¼é€è¨Šæ¯
const response = await chat(userInput);

// 3. è™•ç†å›æ‡‰
if (response.intent === 'casual_chat') {
  // é¡¯ç¤ºå°è©±
  setMessages(prev => [...prev, {
    role: 'ai',
    content: response.reply
  }]);
} else if (response.suggestions && response.suggestions.length > 0) {
  // å»ºç«‹å»ºè­°å¡
  for (const suggestion of response.suggestions) {
    await storage.createItem({
      ...suggestion,
      status: 'suggestion'
    });
  }
}
```

### éœ€è¦çš„ç‹€æ…‹ç®¡ç†

```typescript
// å°è©±æ­·å²
const [messages, setMessages] = useState<ChatMessage[]>([]);

// AI å›æ‡‰
const [aiResponse, setAIResponse] = useState<ChatResponse | null>(null);

// å°è©±æ¨¡å¼ vs ç›´æ¥å»ºå¡æ¨¡å¼
const [mode, setMode] = useState<'chat' | 'direct'>('chat');
```

## æ³¨æ„äº‹é …

1. **API Key è¨­å®š**ï¼šä½¿ç”¨è€…å¿…é ˆå…ˆåœ¨ã€Œè¨­å®šã€é é¢é…ç½® AI API é‡‘é‘°
2. **éŒ¯èª¤è™•ç†**ï¼šå¦‚æœ AI API ä¸å¯ç”¨ï¼Œé™ç´šå›é—œéµå­—åŒ¹é…
3. **æˆæœ¬æ§åˆ¶**ï¼šæ¯æ¬¡å‘¼å«éƒ½æœƒæ¶ˆè€— API é¡åº¦
4. **å›æ‡‰æ™‚é–“**ï¼šAI API å›æ‡‰å¯èƒ½éœ€è¦ 2-5 ç§’

## ä¸‹ä¸€æ­¥

1. å…ˆåŸ·è¡Œ SQL ä¿®å¾©è…³æœ¬ï¼ˆä¿®æ­£ status ç´„æŸå•é¡Œï¼‰
2. å¯¦ä½œæœ€å°å¯è¡Œç‰ˆæœ¬çš„å°è©±åŠŸèƒ½
3. æ¸¬è©¦å„ç¨®è¼¸å…¥æƒ…å¢ƒ
4. æ”¶é›†ä½¿ç”¨è€…å›é¥‹
5. é€æ­¥åŠ å…¥å¤šè¼ªå°è©±åŠŸèƒ½

---

**å„ªå…ˆç´š**ï¼šğŸ”´ é«˜ï¼ˆç«‹å³åŸ·è¡Œï¼‰
**é ä¼°æ™‚é–“**ï¼š2-3 å°æ™‚ï¼ˆæœ€å°å¯è¡Œç‰ˆæœ¬ï¼‰
**ä¾è³´é …ç›®**ï¼š
- âœ… AIService å·²å¯¦ä½œ
- âœ… useAIChat Hook å·²å¯¦ä½œ
- â³ éœ€è¦ AI API é‡‘é‘°è¨­å®š
