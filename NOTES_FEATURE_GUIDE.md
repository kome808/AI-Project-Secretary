# 備註功能使用指南

## ✅ 已完成的功能

備註功能已經完整實作並整合到以下位置：

### 1. 📝 在編輯對話框中添加備註

**位置**：當您點擊「新增任務」或「編輯任務」時

**步驟**：
1. 在「專案工作」頁面，點擊任何工作包的「➕ 新增任務」按鈕
2. 或點擊現有任務的「⋮」選單 → 「編輯」
3. 在彈出的對話框中，您會看到「備註」欄位（在「期限」欄位下方）
4. 在「備註」欄位中輸入文字
5. 點擊「儲存」

### 2. 📋 在任務卡片中查看/編輯備註

**位置**：在任務卡片的展開區域

**步驟**：
1. 找到任何任務卡片
2. 點擊卡片左側的 **「>」圖示** 展開任務詳情
3. 在展開區域的底部，您會看到備註區域（在「更新於」下方）
4. 如果還沒有備註，會顯示「點擊新增備註」
5. 點擊備註區域進入編輯模式
6. 輸入文字後按 `Ctrl+Enter` 儲存，或按 `Esc` 取消

### 3. 🔄 備註功能特點

- **即時編輯**：點擊備註區域直接編輯
- **快捷鍵**：
  - `Ctrl+Enter`（或 `Cmd+Enter`）：儲存
  - `Esc`：取消編輯
- **智能預覽**：超過 2 行的備註會自動折疊，顯示「展開全文」按鈕
- **時間追蹤**：顯示最後更新時間（剛剛、X分鐘前、完整日期）
- **更新者追蹤**：顯示是誰更新的備註

## 🎨 組件位置

所有備註相關的代碼都在以下位置：

- **類型定義**：`/src/lib/storage/types.ts`（Item.notes, notes_updated_at, notes_updated_by）
- **備註組件**：`/src/app/tasks/components/ItemNotes.tsx`
- **編輯對話框**：`/src/app/tasks/components/ItemEditDialog.tsx`（第 176-185 行）
- **任務卡片整合**：
  - `/src/app/tasks/components/CompactItemCard.tsx`（第 217-236 行）
  - `/src/app/tasks/components/ExpandableItemCard.tsx`（展開視圖底部）

## 🔍 如何測試

1. 前往「任務清單」→「專案工作」
2. 如果沒有工作包，先建立一個（點擊「➕ 新增工作包」）
3. 在工作包中建立任務（點擊工作包卡片的「➕ 新增任務」）
4. 在彈出的對話框中，向下滾動找到「備註」欄位
5. 輸入一些備註文字，例如：「這是測試備註\n第二行內容」
6. 點擊「儲存」
7. 找到剛建立的任務卡片，點擊左側的「>」圖示展開
8. 在展開區域的底部，您應該會看到剛才輸入的備註
9. 點擊備註區域可以進行編輯

## 📌 提醒

備註功能在以下三種卡片組件中都可用：
- **CompactItemCard**（用於專案工作視圖）
- **ExpandableItemCard**（用於待回覆/需求變更視圖）
- **ItemCard**（用於決議視圖）

所有這些卡片都需要**展開**才能看到備註區域！
